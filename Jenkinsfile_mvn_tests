pipeline {
    agent any
    stages {
        stage("build-staging") {
            steps {
                script {
                    successJob = 'false'
                    build('STAGING')
                }
            }
        }
        stage('deploy-staging') {
            steps {
                script {
                    deploy('STAGING')
                    echo successJob;
                }
            }
        }
        stage('test-staging') {
            steps {
                script {
                    test('STAGING')
                }
            }
        }
    }
}

def successJob = 'true'

def build(String environment) {
    echo "Build on ${environment} was started"
    echo "The build number - ${env.BUILD_NUMBER}"
    sh 'echo  Execution servertime - `date`'
    env.STAGE_STATUS = 'OK'
}

def deploy(String environment) {
    echo "Deploy started on ${environment}"
    echo "${env.STAGE_STATUS}"
}

def test(String environment) {
    echo "Test executed on ${environment}"
}